<!doctype html>
<html lang="en">
    <head>
        <link rel="shortcut icon" type="image/x-icon" href="/aow4db/favicon.ico" />
        <link rel="stylesheet" type="text/css" href="/aow4db/Style/style.css" />
        <meta charset="UTF-8" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script src="/aow4db/Data/HeroBeta.js"></script>

        <script>
            $("#body").ready(function () {
                $("#header").load("/aow4db/HTML/header.html", function () {
                    CheckData();
                    // GetLocalData();

                    // Get the dropdown element
                    const dropdownOrigin = document.getElementById("actionDropdownOrigin");
                    const dropdownOriginDragon = document.getElementById("actionDropdownOriginDragon");

                    // hide dragon type
                    document.getElementById("actionDropdownOriginDragonHolder").style.display = "none";

                    const dropdown = document.getElementById("actionDropdownClass");
                    // Add an event listener for when the value changes
                    dropdownOrigin.addEventListener("change", function () {
                        document.getElementById("actionDropdownOriginDragonHolder").style.display = "none";
                        // Get the selected value
                        const selectedValue = dropdownOrigin.value;
                        rulerOrigin = selectedValue;

                        document.getElementById("Warrior").disabled = false;
                        document.getElementById("Defender").disabled = false;
                        document.getElementById("Ranger").disabled = false;
                        document.getElementById("Ritualist").disabled = false;
                        document.getElementById("Mage").disabled = false;
                        if (selectedValue == "Dragon") {
                            // show the dragon selection
                            document.getElementById("actionDropdownOriginDragonHolder").style.display = "block";
                            // dont leave ranger
                            document.getElementById("Ranger").disabled = true;
                            if (rulerClass == "Ranger") {
                                rulerClass = "Warrior";
                            }
                        }
                        if (selectedValue == "Eldritch") {
                            document.getElementById("Defender").disabled = true;
                            document.getElementById("Warrior").disabled = true;
                            document.getElementById("Ranger").disabled = true;
                            document.getElementById("DeathKnight").disabled = true;
                            document.getElementById("Spellblade").disabled = true;
                            // no defender, ranger, or warrior?
                            if (rulerClass == "Ranger" || rulerClass == "Warrior" || rulerClass == "Defender") {
                                rulerClass = "Mage";
                                document.getElementById("actionDropdownClass").value = "Mage";
                            }
                        }

                        ResetAll();

                        //UpdatePage();

                        // Trigger functions based on the selected value
                    });

                    // Add an event listener for when the value changes
                    dropdownOriginDragon.addEventListener("change", function () {
                        // Get the selected value
                        const selectedValue = dropdownOriginDragon.value;
                        rulerDragonOrigin = selectedValue;
                        ResetAll();

                        // Trigger functions based on the selected value
                    });

                    // Add an event listener for when the value changes
                    dropdown.addEventListener("change", function () {
                        // Get the selected value
                        const selectedValue = dropdown.value;
                        rulerClass = selectedValue;
                        ResetAll();

                        // Trigger functions based on the selected value
                    });
                });
            });

            function HandlePage() {
                if (searchKeyword) {
                    TestLoad(searchKeyword);
                } else {
                    ResetAll();
                    // UpdatePage();
                }
            }

            function myFunction() {
                // Get the text field
                var copyText = document.getElementById("shareLink");

                // Select the text field
                copyText.select();
                copyText.setSelectionRange(0, 99999); // For mobile devices

                // Copy the text inside the text field
                navigator.clipboard.writeText(copyText.value);

                // Alert the copied text
                // alert("Copied the text: " + copyText.value);
            }
        </script>

        <title>Age of Wonders 4 Database - Hero Skill Tree Builder Beta</title>
    </head>

    <body>
        <div id="header"></div>
        <div style="color: white; display: block; margin: 5px; margin-left: auto; margin-right: auto">
            WIP, no Dragon Breath Affinity support yet, always showing Materium breath
            <!--<div style="display: flex; flex-direction: row; justify-content: center">
                <button class="button-random" onclick="GetQuickLinkHero()">Make Share Link</button>
                <input type="text" value="" class="inputfield" id="shareLink" style="width: 600px" />

                <button class="button-random" id="copyButton" onclick="myFunction()">Copy</button><br />
            </div>-->
            <div style="display: flex; flex-direction: row; justify-content: center">
                TIGER 1.3 BETA STUFF, NO SHARING LINKS TILL ITS LIVE
                <button class="button-random" id="reset" onclick="ResetAll()">Reset All</button><br />
            </div>
        </div>

        <div class="textblocktitle">
            <div style="display: flex; flex-direction: row; justify-content: space-evenly">
                <span class="small_title">
                    Skill Points:
                    <span id="currentSkillPoints"></span>
                </span>
                <div>
                    <span class="small_title"> Build Name</span>
                    <input
                        type="text"
                        value="My Build"
                        class="inputfield"
                        id="buildNameInput"
                        maxlength="60"
                        name="fname" />
                </div>
            </div>
        </div>

        <div class="tree-space" id="treespace">
            <div class="choices" style="left: 100px; top: 20px">
                <label style="color: white">Ruler Type:</label>
                <select id="actionDropdownOrigin">
                    <option id="Champion" value="Champion">Champion</option>
                    <option id="Wizard" value="Wizard">Wizard King</option>
                    <option id="Dragon" value="Dragon">Dragon Lord</option>
                    <option id="Eldritch" value="Eldritch">Eldritch Sovereign</option>
                </select>
            </div>
            <div class="choices" id="actionDropdownOriginDragonHolder" style="left: 100px; top: -20px">
                <label style="color: white">Dragon Type:</label>
                <select id="actionDropdownOriginDragon">
                    <option id="orderDragon" value="OrderDragon">Order Dragon</option>
                    <option id="astralDragon" value="AstralDragon">Astral Dragon</option>
                    <option id="natureDragon" value="NatureDragon">Nature Dragon</option>
                    <option id="chaosDragon" value="ChaosDragon">Chaos Dragon</option>
                    <option id="materiumDragon" value="MateriumDragon">Materium Dragon</option>
                    <option id="shadowDragon" value="ShadowDragon">Shadow Dragon</option>
                </select>
            </div>
            <div class="choices" style="left: 900px; top: 20px">
                <label style="color: white">Class:</label>
                <select id="actionDropdownClass">
                    <option class="dropdownOption" id="Warrior" value="Warrior">Warrior</option>
                    <option id="Ranger" value="Ranger">Ranger</option>
                    <option id="Mage" value="Mage">Mage</option>
                    <option id="Defender" value="Defender">Defender</option>
                    <option id="Ritualist" value="Ritualist">Ritualist</option>
                    <option id="DeathKnight" value="Death Knight">Death Knight</option>
                    <option id="Spellblade" value="Spellblade">Spellblade</option>
                </select>
            </div>
            <div style="position: relative; display: flex; justify-content: flex-start">
                <div style="position: relative">
                    <div class="tree-grid" id="treeHolder"></div>
                    <div class="" id="treeLineHolder"></div>
                </div>

                <div style="position: relative">
                    <div class="tree-grid" id="treeHolderClass"></div>
                    <div class="" id="treeLineHolderClass"></div>
                </div>
                <div>
                    <div class="tree-grid" id="treeHolderSignature1"></div>
                    <div class="" style="position: relative" id="treeLineHolderSignature1"></div>
                    <div class="tree-grid" id="treeHolderSignature2"></div>
                    <div class="" style="position: relative" id="treeLineHolderSignature2"></div>
                    <div class="tree-grid" id="treeHolderSignature3"></div>
                    <div class="" style="position: relative" id="treeLineHolderSignature3"></div>
                    <div class="tree-grid" id="treeHolderSignature4"></div>
                    <div class="" style="position: relative" id="treeLineHolderSignature4"></div>
                </div>
            </div>

            <div class="choices" style="left: 1400px; top: 20px">
                <label style="color: white">Affinity Skills:</label>
            </div>
        </div>
        <div id="summaryHolder" style="position: absolute; top: 718px; width: 400px; left: 70px; color: white"></div>
        <div class="selections" id="selectionsHolder">
            <p id="selections" style="text-align: center"></p>
            <button
                style="float: right; position: relative; top: -20px; color: red"
                class="button"
                onclick="closePanel()">
                X
            </button>

            <div id="choicesPanel" class="wrappers"></div>
        </div>
    </body>
</html>
<style>
    .option:disabled {
        color: gray;
        background-color: #f9f9f9;
        cursor: not-allowed;
    }
    .wrappers {
        position: relative;

        display: grid;
        grid-template-columns: repeat(7, 2fr);
        overflow-y: auto;
        max-height: 300px;
        height: fit-content;
    }

    .choices {
        position: absolute;
        font-size: 30px;
        z-index: 20;
    }

    .selections {
        width: fit-content;

        height: fit-content;
        max-height: 300px;
        color: white;
        display: inline-block;
        position: absolute;
        border-width: 10px;
        border-style: solid;
        border-image: url(/aow4db/Icons/9slicetooltip.png);
        border-image-slice: 10 10 10 10;
        background-color: black;
        z-index: 10;
    }
    .branch-line {
        height: 6px;
        margin-top: -6px;
        position: absolute;

        transform-origin: left center;
        background-color: black;
        background-size: 10px;
        width: 60px;
    }

    .dotted-line {
        height: 4px;
        margin-top: -6px;
        position: absolute;

        transform-origin: left center;
        background-image: url(/aow4db/Icons/Interface/talents-arrow-line-gray.png);
        background-size: 10px;
        width: 25px;
    }

    .tree-grid {
        position: relative; /* Required for children to be positioned relative to the parent */
        display: inline-block;

        position: relative;
    }

    .tree-space {
        width: auto;
        height: 1920px;
        min-width: min-content;
        position: relative;
        background-size: cover;
        background-image: url(/aow4db/Icons/Interface/panel_Background2.png);
    }

    .entry {
        background-color: transparent;
        color: aliceblue;
        text-align: center;
    }

    /* Default style for the node container */
    .unittype_ic {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 60px;
        height: 60px;
        z-index: 2;
        margin: 10px;
    }

    /* Square shape */
    .shape-square {
        width: 55px;
        height: 55px;
        background-color: black;
        border: 2px solid #d7c297;
    }

    /* Square shape */
    .shape-signature {
        width: 70px;
        height: 70px;

        filter: brightness(100%);
    }

    /* Square shape */
    .shape-square.activated {
        background-color: green;
        border: 2px solid #a7d797;
        filter: brightness(120%);
    }

    /* shield shape */
    .shape-shield {
        background-image: url(/aow4db/Icons/Interface/passive.png);
        background-size: 65px;
        background-position: center;
        background-repeat: no-repeat;

        width: 70px;
        height: 70px;
    }

    .shape-shield.activated {
        background-image: url(/aow4db/Icons/Interface/passiveSelected.png);

        filter: brightness(120%);
    }

    /* Diamond shape */
    .shape-diamond {
        background-image: url(/aow4db/Icons/Interface/ability_icon.png);
        background-size: contain;

        width: 90px;
        height: 90px;
    }

    /* Diamond shape */
    .shape-diamond.activated {
        background-image: url(/aow4db/Icons/Interface/ability_iconActive.png);
        filter: brightness(120%);
    }

    /* Diamond shape */
    .shape-circle {
        background-image: url(/aow4db/Icons/Interface/EquipmentIcon.png);
        background-size: 70px;
        background-repeat: no-repeat;
        width: 70px;
        height: 70px;
    }

    /* Diamond shape */
    .shape-circle.activated {
        background-image: url(/aow4db/Icons/Interface/ItemBGActive.png);

        filter: brightness(120%);
    }

    .empireNodeIcon {
    }
    .color-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        /* Change this color as needed */

        pointer-events: none;
    }

    /* To prevent the image inside from rotating along with the diamond shape
    .shape-diamond img {
        transform: rotate(-45deg);
    } */

    .shape-diamond,
    .shape-shield,
    .shape-circle,
    .shape-square {
        filter: brightness(50%);
    }

    .empireNodeIcon:hover {
        filter: brightness(150%);
    }

    .selectable {
        filter: brightness(120%);
    }

    .blocked {
        filter: grayscale(100);
    }
</style>
<footer>
    <br />
    <br />
</footer>
